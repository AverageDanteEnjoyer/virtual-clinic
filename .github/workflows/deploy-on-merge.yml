 name: Deploy site to gh pages

 on:
  push:
    branches:
      - add-gh-pages-deploy
      
 # Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
 permissions:
  contents: read
  pages: write
  id-token: write
      
 # Allow one concurrent deployment
 concurrency:
  group: "pages"
  cancel-in-progress: true
  
 jobs:
 
   # Build job
   build:
     # At a minimum this job should upload artifacts using actions/upload-pages-artifact
     runs-on: ubuntu-latest
     steps:
     - name: Checkout
       uses: actions/checkout@v3
       with:
          ref: add-gh-pages-deploy
          
     - name: Setup Node
       uses: actions/setup-node@v3
       with:
          node-version: "16"
          
     - name: Install dependencies
       run: yarn install
       
     - name: Build 
       run: yarn build
       
     - name: Create artifact
       uses: actions/upload-pages-artifact@v1
       with:
          path: ./public

   # Deploy job
   deploy:
     # Add a dependency to the build job
     needs: build

     # Grant GITHUB_TOKEN the permissions required to make a Pages deployment
     permissions:
       pages: write      # to deploy to Pages
       id-token: write   # to verify the deployment originates from an appropriate source

     # Deploy to the github-pages environment
     environment:
       name: github-pages
       url: ${{ steps.deployment.outputs.page_url }}

     # Specify runner + deployment step
     runs-on: ubuntu-latest
     steps:
       - name: Deploy to GitHub Pages
         id: deployment
         uses: actions/deploy-pages@v1
         
